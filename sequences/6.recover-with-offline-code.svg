<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1303" height="2845"><desc>title%20Recover%20with%20offline%20code%0A%0AYourClient-%3EYourClient%3A%20Click%20recovery%0A%0AYourClient-%3EYourClient%3A%20Enter%20username%0A%0AYourClient-%3EYourServer%3A%20Up%20to%20your%20dApp%20but%20you%20can%20put%20some%20device%5Cnvalidation%20on%20here%20like%20email%20validation%20etc%5Cnbefore%20you%20return%20the%20recovery%20encrypted%20key.%5CnUse%20the%20recovery%20authentication%20token%20as%20a%20way%20to%20identify%5Cnthe%20user.%0A%0AYourClient-%3EYourClient%3A%20Enter%20offline%20recovery%20code%0A%0AYourClient-%3EThisPackage%3A%20getOfflineRecoveryAuthenticationInfo('username'%2C'offline_recovery_code')%0A%0AThisPackage-%3EYourClient%3A%20Return%3A%5Cn-%20recoveryAuthenticationToken%5Cn-%20recoveryId%0A%0AYourClient-%3EYourServer%3A%20Get%20the%20recovery%20encrypted%20key%20info%20for%20the%20user%3A%20%5Cn-%20username%20%5Cn-%20recoveryAuthenticationToken%5Cn-%20offlineRecoveryCodeId%0A%0AYourServer-%3EYourServer%3A%20Looking%20from%20db%20using%20username%20%2B%20offlineRecoveryCodeId%3A%20%5Cn-%20serverRecoveryAuthenticationToken%5Cn-%20salt%5Cn-%20RecoveryEncryptedKeyInfo.key%5Cn-%20RecoveryEncryptedKeyInfo.iv%0A%0AYourServer-%3EThisPackage%3AserverHashMatchesClientHash(salt%2C%20clientRecoveryAuthenticationToken%2C%20serverRecoveryAuthenticationToken)%5Cn%5CnMakes%20sure%20the%20stored%20auth%20token%20matches%20the%20one%20sending%20in%20before%20returning%20the%20encrypted%20info%5Cn%5CnIf%20you%20are%20not%20using%20node%20as%20your%20backend%20the%20github%5Creadme%20explains%20what%20this%20method%20does%20so%20you%20can%5Cnwrite%20it%20in%20the%20language%20your%20using.%0A%0AThisPackage-%3EYourServer%3ABoolean%20result%0A%0AYourServer-%3EYourServer%3AIf%20false%20do%20not%20carry%20on%20and%20return%5Cnand%204xx%20http%20code%20back%20to%20your%20client.%0A%0AYourServer-%3EYourClient%3A%20Returns%3A%5Cn-%20RecoveryEncryptedKeyInfo.key%5Cn-%20RecoveryEncryptedKeyInfo.iv%0A%0AYourClient-%3EYourClient%3A%20Enter%20new%20password%0A%0AYourClient-%3EThisPackage%3A%20recoveryWithOfflineCode(%5Cn'username'%2C%20%5Cnrecovery_code%2C%5Cn'new_password'%2C%5Cn%20RecoveryEncryptedKeyInfo)%0A%0AThisPackage-%3EYourClient%3A%20return%20RecoveryEncryptedWallet%20object%0A%0AYourClient-%3EYourServer%3ASend%20to%20the%20server%20%5Cn%20-%20Username%5Cn%20-%20RecoveryEncryptedWallet.offlineRecoveryId%20%5Cn%20-%20RecoveryEncryptedWallet.wallet.ethereumAddress%20%5Cn%20-%20RecoveryEncryptedWallet.signature%20%5Cn%20-%20RecoveryEncryptedWallet.userAuthenticationToken%2C%20%5Cn%20-%20RecoveryEncryptedWallet.encryptedKeyInfo.key%20%5Cn%20-%20RecoveryEncryptedWallet.encryptedKeyInfo.iv%5Cn%5CnThe%20signature%20is%20a%20signed%20hash%20of%20the%20encrypted%5Cnprivate%20key%20%2B%20iv%20signed%20with%20your%20ethereum%20private%20key%5Cn%5CnAs%20you%20have%20this%20signature%20here%20you%20in%20theory%20can%5Cnverify%20the%20ethereum%20address%20is%20owned%20by%20this%20user.%5CnYou%20can%20add%20more%20authentication%20in%20here%20like%20a%20%5Cnjwt%20token%20or%20something%20along%20those%20lines%20but%20that%5Cnis%20up%20to%20you%20to%20decide%20depending%20on%20your%20dApps%5Cnrequirements.%0A%0AYourServer-%3EYourServer%3Acheck%20username%20%2B%20RecoveryEncryptedWallet.offlineRecoveryId%20exist%0A%0AYourServer-%3EYourServer%3AIf%20false%20do%20not%20carry%20on%20and%20return%5Cnand%204xx%20http%20code%20back%20to%20your%20client.%0A%0AYourServer-%3EThisPackage%3AverifyEthereumAddress(RecoveryEncryptedWallet.signature%2C%5CnRecoveryEncryptedWallet.encryptedKeyInfo%2C%5CnRecoveryEncryptedWallet.wallet.ethereumAddress)%5Cn%5CnThe%20signature%20is%20a%20signed%20hash%20of%20the%20encrypted%5Cnprivate%20key%20%2B%20iv%20signed%20with%20your%20ethereum%20private%20key%5Cn%5CnIf%20you%20are%20not%20using%20node%20as%20your%20backend%20the%20github%5Creadme%20explains%20what%20this%20method%20does%20so%20you%20can%5Cnwrite%20it%20in%20the%20language%20your%20using.%0A%0AThisPackage-%3EYourServer%3ABoolean%20result%0A%0AYourServer-%3EYourServer%3AIf%20false%20do%20not%20carry%20on%20and%20return%5Cnand%204xx%20http%20code%20back%20to%20your%20client.%0A%0AYourServer-%3EThisPackage%3AhashAuthenticationTokenOnServer(RecoveryEncryptedWallet.userAuthenticationToken)%5CnThis%20returns%20a%20random%20salt%20and%20the%20server%20authentication%20hash%5Cn(HashAuthenticationTokenOnServerResponse)%5Cn%5CnIf%20you%20are%20not%20using%20node%20as%20your%20backend%20the%20github%5Creadme%20explains%20what%20this%20method%20does%20so%20you%20can%5Cnwrite%20it%20in%20the%20language%20your%20using.%0A%0AThisPackage-%3EYourServer%3Areturn%20HashAuthenticationTokenOnServerResponse%5Cn-%20HashAuthenticationTokenOnServerResponse.serverAuthenticationHash%5Cn-%20HashAuthenticationTokenOnServerResponse.salt%0A%0AYourServer-%3EYourServer%3AReplace%20in%20db%20mapped%20to%20username%20%5Cn%20-%20HashAuthenticationTokenOnServerResponse.serverAuthenticationHash%5Cn%20-%20HashAuthenticationTokenOnServerResponse.salt%5Cn%20-%20RecoveryEncryptedWallet.encryptedKeyInfo.key%20%5Cn%20-%20RecoveryEncryptedWallet.encryptedKeyInfo.iv%5Cn%0A%0AYourServer-%3EYourServer%3ARemove%20from%20recovery%20code%20table%20using%20username%20%2B%20RecoveryEncryptedWallet.offlineRecoveryId%3A%20%5Cn%20-%20RecoveryEncryptedWallet.userRecoveryCodeAuthenticationToken%2C%20%5Cn%20-%20RecoveryEncryptedWallet.recoveryEncryptedKeyInfo.key%20%5Cn%20-%20RecoveryEncryptedWallet.recoveryEncryptedKeyInfo.iv%5CnAs%20it%20has%20now%20been%20redeemed%20remove%20from%20your%20server%0A%0AYourServer-%3EYourClient%3A%20Done%0A%0AYourClient-%3EYourClient%3A%20RecoveryEncryptedWallet.wallet%20holds%20ethereum%20address%20%5Cn%20and%20private%20key%20to%20do%20any%20signing%20on%20the%20client%0A%0AYourClient-%3EYourClient%3A%20Recovery%20successful%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1303" height="2845"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="529.0359610679349" y="24.50280495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Recover with offline code</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 59.44174278714063 95.887643371 L 59.44174278714063 2845.102358761" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 477.85537329938023 95.887643371 L 477.85537329938023 2845.102358761" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1235.2022313506823 95.887643371 L 1235.2022313506823 2845.102358761" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.167601650000002 51.782594461 L 110.71588392428126 51.782594461 L 110.71588392428126 95.887643371 L 8.167601650000002 95.887643371 L 8.167601650000002 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="25.891297230500008" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">YourClient</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 423.7322789151693 51.782594461 L 531.9784676835911 51.782594461 L 531.9784676835911 95.887643371 L 423.7322789151693 95.887643371 L 423.7322789151693 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="441.4559744956693" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">YourServer</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1175.1056109654949 51.782594461 L 1295.29885173587 51.782594461 L 1295.29885173587 95.887643371 L 1175.1056109654949 95.887643371 L 1175.1056109654949 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1192.8293065459948" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">ThisPackage</text></g></g><g><g><g><rect fill="white" stroke="none" x="78.7717333588073" y="128.558049971" width="96.94774116578125" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="81.2220138538073" y="143.259732941" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Click recovery</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 59.44174278714063 149.793814261 L 124.78255598714063 149.793814261 L 124.78255598714063 171.029578551 L 72.8910601708073 171.029578551" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(59.44174278714063,171.029578551) translate(-59.44174278714063,-171.029578551)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 73.0544122038073 164.22324384266665 L 59.44174278714063 171.029578551 L 73.0544122038073 177.83591325933332 Z"/></g></g><g><g><rect fill="white" stroke="none" x="78.7717333588073" y="195.53238350099997" width="109.20259346070313" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="81.2220138538073" y="210.23406647099995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Enter username</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 59.44174278714063 216.768147791 L 124.78255598714063 216.768147791 L 124.78255598714063 238.00391208099998 L 72.8910601708073 238.00391208099998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(59.44174278714063,238.00391208099998) translate(-59.44174278714063,-238.00391208099998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 73.0544122038073 231.19757737266664 L 59.44174278714063 238.00391208099998 L 73.0544122038073 244.81024678933332 Z"/></g></g><g><g><rect fill="white" stroke="none" x="78.77173335880731" y="262.506717031" width="301.5361200720312" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="78.77173335880731" y="278.841920331" width="275.451586380625" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="78.77173335880731" y="295.177123631" width="299.6104608923437" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="78.77173335880731" y="311.51232693099996" width="379.7536493689062" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="78.77173335880731" y="327.84753023099995" width="61.135317459726565" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="81.22201385380731" y="277.208400001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Up to your dApp but you can put some device</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="81.22201385380731" y="293.54360330099996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">validation on here like email validation etc</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="81.22201385380731" y="309.87880660099995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">before you return the recovery encrypted key.</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="81.22201385380731" y="326.21400990099994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Use the recovery authentication token as a way to identify</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="81.22201385380731" y="342.54921320099993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">the user.</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 59.44174278714063 349.08329452099997 L 464.4060559157136 349.08329452099997" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(477.85537329938023,349.08329452099997) translate(-477.85537329938023,-349.08329452099997)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 464.24270388271356 342.27695981266663 L 477.85537329938023 349.08329452099997 L 464.24270388271356 355.8896292293333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="78.7717333588073" y="373.58609947099995" width="179.01642097535156" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="81.2220138538073" y="388.28778244099993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Enter offline recovery code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 59.44174278714063 394.8218637609999 L 124.78255598714063 394.8218637609999 L 124.78255598714063 416.05762805099994 L 72.8910601708073 416.05762805099994" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(59.44174278714063,416.05762805099994) translate(-59.44174278714063,-416.05762805099994)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 73.0544122038073 409.2512933426666 L 59.44174278714063 416.05762805099994 L 73.0544122038073 422.8639627593333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="407.2948938297708" y="440.5604330009999" width="480.0541864782812" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="409.7451743247708" y="455.2621159709999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">getOfflineRecoveryAuthenticationInfo('username','offline_recovery_code')</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 59.44174278714063 461.79619729099994 L 1221.7529139670155 461.79619729099994" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1235.2022313506823,461.79619729099994) translate(-1235.2022313506823,-461.79619729099994)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1221.5895619340156 454.9898625826666 L 1235.2022313506823 461.79619729099994 L 1221.5895619340156 468.6025319993333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="546.2711893009622" y="486.2990022409999" width="52.97499336304688" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="546.2711893009622" y="502.6342055409999" width="202.10159553589844" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="546.2711893009622" y="518.9694088409999" width="82.29492439332031" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="548.7214697959622" y="501.0006852109999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="548.7214697959622" y="517.3358885109999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">- recoveryAuthenticationToken</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="548.7214697959622" y="533.6710918109999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">- recoveryId</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1235.2022313506823 540.2051731309999 L 72.8910601708073 540.2051731309999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(59.44174278714063,540.2051731309999) translate(-59.44174278714063,-540.2051731309999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 73.0544122038073 533.3988384226666 L 59.44174278714063 540.2051731309999 L 73.0544122038073 547.0115078393333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="107.30429561466669" y="564.707978081" width="322.6885248571875" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="107.30429561466669" y="581.043181381" width="83.11813606324219" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="107.30429561466669" y="597.378384681" width="202.10159553589844" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="107.30429561466669" y="613.7135879809999" width="161.90120185914063" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="109.75457610966669" y="579.409661051" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Get the recovery encrypted key info for the user: </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="109.75457610966669" y="595.7448643509999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">- username </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="109.75457610966669" y="612.0800676509999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">- recoveryAuthenticationToken</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="109.75457610966669" y="628.4152709509999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">- offlineRecoveryCodeId</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 59.44174278714063 634.949352271 L 464.4060559157136 634.949352271" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(477.85537329938023,634.949352271) translate(-477.85537329938023,-634.949352271)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 464.24270388271356 628.1430175626666 L 477.85537329938023 634.949352271 L 464.24270388271356 641.7556869793333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="497.1853638710469" y="659.452157221" width="391.3069940954687" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="497.1853638710469" y="675.787360521" width="248.53679145875" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="497.1853638710469" y="692.122563821" width="36.66861213746094" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="497.1853638710469" y="708.457767121" width="218.37933601441406" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="497.1853638710469" y="724.792970421" width="206.15313972535156" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660469" y="674.153840191" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Looking from db using username + offlineRecoveryCodeId: </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660469" y="690.489043491" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">- serverRecoveryAuthenticationToken</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660469" y="706.824246791" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">- salt</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660469" y="723.1594500909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">- RecoveryEncryptedKeyInfo.key</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660469" y="739.4946533909999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">- RecoveryEncryptedKeyInfo.iv</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 477.85537329938023 746.028734711 L 543.1961864993802 746.028734711 L 543.1961864993802 767.264499001 L 491.3046906830469 767.264499001" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(477.85537329938023,767.264499001) translate(-477.85537329938023,-767.264499001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 491.4680427160469 760.4581642926667 L 477.85537329938023 767.264499001 L 491.4680427160469 774.0708337093333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="497.1853638710468" y="791.767303951" width="718.6868769079688" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="497.1853638710468" y="808.102507251" width="4.90056099" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="497.1853638710468" y="824.437710551" width="634.0412470251563" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="497.1853638710468" y="840.772913851" width="4.90056099" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="497.1853638710468" y="857.108117151" width="683.7620722204688" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="497.1853638710468" y="873.443320451" width="227.37719978394531" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660468" y="806.468986921" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">serverHashMatchesClientHash(salt, clientRecoveryAuthenticationToken, serverRecoveryAuthenticationToken)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660468" y="822.804190221" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660468" y="839.139393521" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Makes sure the stored auth token matches the one sending in before returning the encrypted info</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660468" y="855.474596821" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660468" y="871.809800121" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">If you are not using node as your backend the github\readme explains what this method does so you can</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660468" y="888.145003421" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">write it in the language your using.</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 477.85537329938023 894.679084741 L 1221.7529139670155 894.679084741" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1235.2022313506823,894.679084741) translate(-1235.2022313506823,-894.679084741)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1221.5895619340156 887.8727500326667 L 1235.2022313506823 894.679084741 L 1221.5895619340156 901.4854194493333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="807.2174149574726" y="919.1818896909999" width="98.62277473511719" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="809.6676954524726" y="933.8835726609999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Boolean result</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1235.2022313506823 940.417653981 L 491.3046906830469 940.417653981" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(477.85537329938023,940.417653981) translate(-477.85537329938023,-940.417653981)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 491.4680427160469 933.6113192726666 L 477.85537329938023 940.417653981 L 491.4680427160469 947.2239886893333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="497.1853638710469" y="964.9204589309999" width="220.8489252478125" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="497.1853638710469" y="981.2556622309999" width="246.93338264527344" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660469" y="979.6221419009998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">If false do not carry on and return</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660469" y="995.9573452009998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">and 4xx http code back to your client.</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 477.85537329938023 1002.4914265209999 L 543.1961864993802 1002.4914265209999 L 543.1961864993802 1023.7271908109999 L 491.3046906830469 1023.7271908109999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(477.85537329938023,1023.7271908109999) translate(-477.85537329938023,-1023.7271908109999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 491.4680427160469 1016.9208561026666 L 477.85537329938023 1023.7271908109999 L 491.4680427160469 1030.5335255193331 Z"/></g></g><g><g><rect fill="white" stroke="none" x="159.45889003605342" y="1048.2299957609998" width="60.3049799353125" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="159.45889003605342" y="1064.565199061" width="218.37933601441406" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="159.45889003605342" y="1080.900402361" width="206.15313972535156" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="161.9091705310534" y="1062.931678731" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Returns:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="161.9091705310534" y="1079.266882031" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">- RecoveryEncryptedKeyInfo.key</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="161.9091705310534" y="1095.6020853310001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">- RecoveryEncryptedKeyInfo.iv</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 477.85537329938023 1102.136166651 L 72.8910601708073 1102.136166651" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(59.44174278714063,1102.136166651) translate(-59.44174278714063,-1102.136166651)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 73.0544122038073 1095.3298319426667 L 59.44174278714063 1102.136166651 L 73.0544122038073 1108.9425013593332 Z"/></g></g><g><g><rect fill="white" stroke="none" x="78.7717333588073" y="1126.6389716009999" width="137.72084297242188" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="81.2220138538073" y="1141.340654571" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Enter new password</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 59.44174278714063 1147.874735891 L 124.78255598714063 1147.874735891 L 124.78255598714063 1169.110500181 L 72.8910601708073 1169.110500181" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(59.44174278714063,1169.110500181) translate(-59.44174278714063,-1169.110500181)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 73.0544122038073 1162.3041654726667 L 59.44174278714063 1169.110500181 L 73.0544122038073 1175.9168348893331 Z"/></g></g><g><g><rect fill="white" stroke="none" x="551.5754037785013" y="1193.6133051309998" width="172.46669258179688" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="551.5754037785013" y="1209.948508431" width="83.83394111695313" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="551.5754037785013" y="1226.283711731" width="105.12956489625" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="551.5754037785013" y="1242.6189150310001" width="112.35934700074219" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="551.5754037785013" y="1258.9541183310002" width="191.49316658082031" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="554.0256842735013" y="1208.314988101" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">recoveryWithOfflineCode(</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="554.0256842735013" y="1224.650191401" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">'username', </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="554.0256842735013" y="1240.9853947010001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">recovery_code,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="554.0256842735013" y="1257.3205980010002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">'new_password',</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="554.0256842735013" y="1273.6558013010003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> RecoveryEncryptedKeyInfo)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 59.44174278714063 1280.189882621 L 1221.7529139670155 1280.189882621" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1235.2022313506823,1280.189882621) translate(-1235.2022313506823,-1280.189882621)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1221.5895619340156 1273.3835479126667 L 1235.2022313506823 1280.189882621 L 1221.5895619340156 1286.9962173293331 Z"/></g></g><g><g><rect fill="white" stroke="none" x="518.0357004093606" y="1304.692687571" width="258.57257331910154" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="520.4859809043606" y="1319.3943705410002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return RecoveryEncryptedWallet object</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1235.2022313506823 1325.928451861 L 72.8910601708073 1325.928451861" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(59.44174278714063,1325.928451861) translate(-59.44174278714063,-1325.928451861)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 73.0544122038073 1319.1221171526668 L 59.44174278714063 1325.928451861 L 73.0544122038073 1332.7347865693332 Z"/></g></g><g><g><rect fill="white" stroke="none" x="89.24420650333856" y="1350.4312568110001" width="128.76593269410156" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="89.24420650333856" y="1366.7664601110002" width="85.5519281775" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="89.24420650333856" y="1383.1016634110003" width="307.1838861853125" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="89.24420650333856" y="1399.4368667110004" width="351.4501825720312" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="89.24420650333856" y="1415.7720700110006" width="254.4924036413672" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="89.24420650333856" y="1432.1072733110007" width="358.8087030798437" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="89.24420650333856" y="1448.4424766110008" width="335.1652094275" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="89.24420650333856" y="1464.7776799110009" width="318.8660150915625" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="89.24420650333856" y="1481.112883211001" width="4.90056099" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="89.24420650333856" y="1497.448086511001" width="313.769457474375" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="89.24420650333856" y="1513.7832898110012" width="354.0557123571875" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="89.24420650333856" y="1530.1184931110013" width="4.90056099" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="89.24420650333856" y="1546.4536964110014" width="325.9813105017187" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="89.24420650333856" y="1562.7888997110015" width="330.8416620642187" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="89.24420650333856" y="1579.1241030110016" width="309.9827143103125" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="89.24420650333856" y="1595.4593063110017" width="318.6513544470312" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="89.24420650333856" y="1611.7945096110018" width="314.6141230017187" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="89.24420650333856" y="1628.129712911002" width="94.52829231324219" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="91.69448699833856" y="1365.1329397810002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Send to the server </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="91.69448699833856" y="1381.4681430810003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> - Username</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="91.69448699833856" y="1397.8033463810004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> - RecoveryEncryptedWallet.offlineRecoveryId </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="91.69448699833856" y="1414.1385496810005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> - RecoveryEncryptedWallet.wallet.ethereumAddress </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="91.69448699833856" y="1430.4737529810006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> - RecoveryEncryptedWallet.signature </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="91.69448699833856" y="1446.8089562810007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> - RecoveryEncryptedWallet.userAuthenticationToken, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="91.69448699833856" y="1463.1441595810008" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> - RecoveryEncryptedWallet.encryptedKeyInfo.key </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="91.69448699833856" y="1479.479362881001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> - RecoveryEncryptedWallet.encryptedKeyInfo.iv</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="91.69448699833856" y="1495.814566181001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="91.69448699833856" y="1512.1497694810012" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">The signature is a signed hash of the encrypted</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="91.69448699833856" y="1528.4849727810013" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">private key + iv signed with your ethereum private key</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="91.69448699833856" y="1544.8201760810014" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="91.69448699833856" y="1561.1553793810015" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">As you have this signature here you in theory can</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="91.69448699833856" y="1577.4905826810016" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">verify the ethereum address is owned by this user.</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="91.69448699833856" y="1593.8257859810017" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">You can add more authentication in here like a </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="91.69448699833856" y="1610.1609892810018" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">jwt token or something along those lines but that</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="91.69448699833856" y="1626.4961925810019" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">is up to you to decide depending on your dApps</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="91.69448699833856" y="1642.831395881002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">requirements.</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 59.44174278714063 1649.365477201 L 464.4060559157136 1649.365477201" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(477.85537329938023,1649.365477201) translate(-477.85537329938023,-1649.365477201)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 464.24270388271356 1642.5591424926668 L 477.85537329938023 1649.365477201 L 464.24270388271356 1656.1718119093332 Z"/></g></g><g><g><rect fill="white" stroke="none" x="497.1853638710469" y="1673.868282151" width="448.565355911875" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660469" y="1688.569965121" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">check username + RecoveryEncryptedWallet.offlineRecoveryId exist</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 477.85537329938023 1695.104046441 L 543.1961864993802 1695.104046441 L 543.1961864993802 1716.339810731 L 491.3046906830469 1716.339810731" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(477.85537329938023,1716.339810731) translate(-477.85537329938023,-1716.339810731)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 491.4680427160469 1709.5334760226667 L 477.85537329938023 1716.339810731 L 491.4680427160469 1723.1461454393332 Z"/></g></g><g><g><rect fill="white" stroke="none" x="497.1853638710469" y="1740.842615681" width="220.8489252478125" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="497.1853638710469" y="1757.1778189810002" width="246.93338264527344" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660469" y="1755.5442986510002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">If false do not carry on and return</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660469" y="1771.8795019510003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">and 4xx http code back to your client.</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 477.85537329938023 1778.413583271 L 543.1961864993802 1778.413583271 L 543.1961864993802 1799.649347561 L 491.3046906830469 1799.649347561" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(477.85537329938023,1799.649347561) translate(-477.85537329938023,-1799.649347561)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 491.4680427160469 1792.8430128526668 L 477.85537329938023 1799.649347561 L 491.4680427160469 1806.4556822693332 Z"/></g></g><g><g><rect fill="white" stroke="none" x="514.6477662147968" y="1824.152152511" width="398.7085443884375" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="514.6477662147968" y="1840.487355811" width="295.2511469275" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="514.6477662147968" y="1856.8225591110001" width="339.2311884314062" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="514.6477662147968" y="1873.1577624110002" width="4.90056099" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="514.6477662147968" y="1889.4929657110004" width="313.769457474375" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="514.6477662147968" y="1905.8281690110005" width="354.0557123571875" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="514.6477662147968" y="1922.1633723110006" width="4.90056099" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="514.6477662147968" y="1938.4985756110007" width="683.7620722204688" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="514.6477662147968" y="1954.8337789110008" width="227.37719978394531" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="517.0980467097968" y="1838.853835481" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">verifyEthereumAddress(RecoveryEncryptedWallet.signature,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="517.0980467097968" y="1855.1890387810001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RecoveryEncryptedWallet.encryptedKeyInfo,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="517.0980467097968" y="1871.5242420810002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RecoveryEncryptedWallet.wallet.ethereumAddress)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="517.0980467097968" y="1887.8594453810003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="517.0980467097968" y="1904.1946486810004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">The signature is a signed hash of the encrypted</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="517.0980467097968" y="1920.5298519810005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">private key + iv signed with your ethereum private key</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="517.0980467097968" y="1936.8650552810007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="517.0980467097968" y="1953.2002585810008" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">If you are not using node as your backend the github\readme explains what this method does so you can</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="517.0980467097968" y="1969.5354618810009" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">write it in the language your using.</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 477.85537329938023 1976.069543201 L 1221.7529139670155 1976.069543201" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1235.2022313506823,1976.069543201) translate(-1235.2022313506823,-1976.069543201)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1221.5895619340156 1969.2632084926668 L 1235.2022313506823 1976.069543201 L 1221.5895619340156 1982.8758779093332 Z"/></g></g><g><g><rect fill="white" stroke="none" x="807.2174149574726" y="2000.5723481510001" width="98.62277473511719" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="809.6676954524726" y="2015.2740311210002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Boolean result</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1235.2022313506823 2021.808112441 L 491.3046906830469 2021.808112441" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(477.85537329938023,2021.808112441) translate(-477.85537329938023,-2021.808112441)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 491.4680427160469 2015.0017777326668 L 477.85537329938023 2021.808112441 L 491.4680427160469 2028.6144471493333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="497.1853638710469" y="2046.3109173910002" width="220.8489252478125" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="497.1853638710469" y="2062.6461206910003" width="246.93338264527344" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660469" y="2061.0126003610003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">If false do not carry on and return</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660469" y="2077.3478036610004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">and 4xx http code back to your client.</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 477.85537329938023 2083.881884981 L 543.1961864993802 2083.881884981 L 543.1961864993802 2105.117649271 L 491.3046906830469 2105.117649271" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(477.85537329938023,2105.117649271) translate(-477.85537329938023,-2105.117649271)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 491.4680427160469 2098.3113145626667 L 477.85537329938023 2105.117649271 L 491.4680427160469 2111.9239839793336 Z"/></g></g><g><g><rect fill="white" stroke="none" x="514.6477662147968" y="2129.620454221" width="573.9554315954688" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="514.6477662147968" y="2145.955657521" width="404.19890083375" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="514.6477662147968" y="2162.290860821" width="309.6678339392187" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="514.6477662147968" y="2178.626064121" width="4.90056099" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="514.6477662147968" y="2194.9612674210002" width="683.7620722204688" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="514.6477662147968" y="2211.2964707210003" width="227.37719978394531" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="517.0980467097968" y="2144.322137191" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">hashAuthenticationTokenOnServer(RecoveryEncryptedWallet.userAuthenticationToken)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="517.0980467097968" y="2160.657340491" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">This returns a random salt and the server authentication hash</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="517.0980467097968" y="2176.992543791" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(HashAuthenticationTokenOnServerResponse)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="517.0980467097968" y="2193.327747091" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="517.0980467097968" y="2209.6629503910003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">If you are not using node as your backend the github\readme explains what this method does so you can</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="517.0980467097968" y="2225.9981536910004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">write it in the language your using.</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 477.85537329938023 2232.532235011 L 1221.7529139670155 2232.532235011" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1235.2022313506823,2232.532235011) translate(-1235.2022313506823,-2232.532235011)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1221.5895619340156 2225.7259003026666 L 1235.2022313506823 2232.532235011 L 1221.5895619340156 2239.3385697193335 Z"/></g></g><g><g><rect fill="white" stroke="none" x="616.1294556679218" y="2257.035039961" width="342.273363724375" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="616.1294556679218" y="2273.3702432610003" width="480.7986933142187" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="616.1294556679218" y="2289.7054465610004" width="335.745043411875" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="618.5797361629218" y="2271.7367229310003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">return HashAuthenticationTokenOnServerResponse</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="618.5797361629218" y="2288.0719262310004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">- HashAuthenticationTokenOnServerResponse.serverAuthenticationHash</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="618.5797361629218" y="2304.4071295310005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">- HashAuthenticationTokenOnServerResponse.salt</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1235.2022313506823 2310.941210851 L 491.3046906830469 2310.941210851" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(477.85537329938023,2310.941210851) translate(-477.85537329938023,-2310.941210851)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 491.4680427160469 2304.1348761426666 L 477.85537329938023 2310.941210851 L 491.4680427160469 2317.7475455593335 Z"/></g></g><g><g><rect fill="white" stroke="none" x="497.1853638710469" y="2335.444015801" width="241.23549140992188" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="497.1853638710469" y="2351.7792191010003" width="484.8716913610937" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="497.1853638710469" y="2368.1144224010004" width="339.81804145875" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="497.1853638710469" y="2384.4496257010005" width="335.1652094275" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="497.1853638710469" y="2400.7848290010006" width="318.8660150915625" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="497.1853638710469" y="2417.1200323010007" width="4.90056099" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660469" y="2350.1456987710003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Replace in db mapped to username </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660469" y="2366.4809020710004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> - HashAuthenticationTokenOnServerResponse.serverAuthenticationHash</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660469" y="2382.8161053710005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> - HashAuthenticationTokenOnServerResponse.salt</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660469" y="2399.1513086710006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> - RecoveryEncryptedWallet.encryptedKeyInfo.key </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660469" y="2415.4865119710007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> - RecoveryEncryptedWallet.encryptedKeyInfo.iv</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660469" y="2431.821715271001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 477.85537329938023 2438.355796591 L 543.1961864993802 2438.355796591 L 543.1961864993802 2459.591560881 L 491.3046906830469 2459.591560881" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(477.85537329938023,2459.591560881) translate(-477.85537329938023,-2459.591560881)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 491.4680427160469 2452.7852261726666 L 477.85537329938023 2459.591560881 L 491.4680427160469 2466.3978955893335 Z"/></g></g><g><g><rect fill="white" stroke="none" x="497.1853638710469" y="2484.094365831" width="643.31120552125" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="497.1853638710469" y="2500.429569131" width="455.773607865" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="497.1853638710469" y="2516.764772431" width="393.0034052282812" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="497.1853638710469" y="2533.099975731" width="376.7042108923437" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="497.1853638710469" y="2549.435179031" width="362.6026483923437" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660469" y="2498.796048801" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Remove from recovery code table using username + RecoveryEncryptedWallet.offlineRecoveryId: </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660469" y="2515.131252101" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> - RecoveryEncryptedWallet.userRecoveryCodeAuthenticationToken, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660469" y="2531.466455401" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> - RecoveryEncryptedWallet.recoveryEncryptedKeyInfo.key </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660469" y="2547.801658701" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> - RecoveryEncryptedWallet.recoveryEncryptedKeyInfo.iv</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="499.6356443660469" y="2564.1368620010003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">As it has now been redeemed remove from your server</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 477.85537329938023 2570.670943321 L 543.1961864993802 2570.670943321 L 543.1961864993802 2591.906707611 L 491.3046906830469 2591.906707611" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(477.85537329938023,2591.906707611) translate(-477.85537329938023,-2591.906707611)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 491.4680427160469 2585.1003729026665 L 477.85537329938023 2591.906707611 L 491.4680427160469 2598.7130423193335 Z"/></g></g><g><g><rect fill="white" stroke="none" x="248.67501552433467" y="2616.4095125609997" width="39.947085037851565" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="251.12529601933466" y="2631.111195531" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Done</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 477.85537329938023 2637.645276851 L 72.8910601708073 2637.645276851" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(59.44174278714063,2637.645276851) translate(-59.44174278714063,-2637.645276851)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 73.0544122038073 2630.8389421426664 L 59.44174278714063 2637.645276851 L 73.0544122038073 2644.4516115593333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="78.7717333588073" y="2662.148081801" width="379.9898554235937" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="78.7717333588073" y="2678.483285101" width="306.4394403845312" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="81.2220138538073" y="2676.849764771" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RecoveryEncryptedWallet.wallet holds ethereum address </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="81.2220138538073" y="2693.184968071" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> and private key to do any signing on the client</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 59.44174278714063 2699.7190493909998 L 124.78255598714063 2699.7190493909998 L 124.78255598714063 2720.954813681 L 72.8910601708073 2720.954813681" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(59.44174278714063,2720.954813681) translate(-59.44174278714063,-2720.954813681)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 73.0544122038073 2714.1484789726665 L 59.44174278714063 2720.954813681 L 73.0544122038073 2727.7611483893334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="78.7717333588073" y="2745.457618631" width="139.33140815796875" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="81.2220138538073" y="2760.159301601" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Recovery successful</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 59.44174278714063 2766.6933829209997 L 124.78255598714063 2766.6933829209997 L 124.78255598714063 2787.929147211 L 72.8910601708073 2787.929147211" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(59.44174278714063,2787.929147211) translate(-59.44174278714063,-2787.929147211)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 73.0544122038073 2781.1228125026664 L 59.44174278714063 2787.929147211 L 73.0544122038073 2794.7354819193333 Z"/></g></g></g><g/><g/><g/></g></svg>